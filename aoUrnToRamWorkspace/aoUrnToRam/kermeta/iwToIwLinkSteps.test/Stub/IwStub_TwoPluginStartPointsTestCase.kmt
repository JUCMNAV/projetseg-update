package aoUrnToRam::test;

require kermeta
require "platform:/lookup/aoUrnToRam/kermeta/iwToIwLinkSteps.test/TestHelper.kmt"

using kermeta::standard
using kermeta::kunit
using intermediateWorkflow

class IwToIwLinkSteps_IwStub_TwoPluginStartPointsTestCase inherits TestCase,IwToIwLinkSteps_TestHelper
{
	reference concern:IwConcern
	reference workflow:IwWorkflow
	reference pluginWorkflow:IwWorkflow
	reference currentStep:IwStep
	
	reference sut:IwStub
	reference pluginStartPoint1:IwStartPoint 
	reference pluginStartPoint2:IwStartPoint
	
	method setUp() is do
		concern:= createIwConcern
    	workflow:=createIwWorkflow_Concern(concern)
    	pluginWorkflow:=createIwWorkflow_Concern(concern)
    	currentStep:=createIwStep_Concern(concern)
    	
		sut:=createIwStaticStub_Workflow(workflow)
		
		pluginStartPoint1:=createIwStartPoint_Workflow(pluginWorkflow)		
		bindStaticStubToPluginStartPoint(sut,pluginStartPoint1)
		
		pluginStartPoint2:=createIwStartPoint_Workflow(pluginWorkflow)		
		bindStaticStubToPluginStartPoint(sut,pluginStartPoint2)
	end
	
	@feature "FeaNamingOfRAMStep"
	operation testDeepFirstSearch_Unexplored_ShouldContinueExploration() is do
		sut.step_DeepFirstSearch(currentStep)
		
		assertEquals(currentStep,pluginStartPoint1.step)
		assertEquals(currentStep,pluginStartPoint2.step)
	end

	@feature "FeaNamingOfRAMStep"
	operation testDeepFirstSearch_Explored_ShouldStopExploration() is do
		sut.step:=currentStep
		
		sut.step_DeepFirstSearch(currentStep)
		
		assertVoid(pluginStartPoint1.step)
		assertVoid(pluginStartPoint2.step)
	end
}