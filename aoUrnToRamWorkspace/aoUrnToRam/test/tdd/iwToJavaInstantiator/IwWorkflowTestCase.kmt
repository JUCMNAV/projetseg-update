package aoUrnToRam::test;

require "platform:/resource/aoUrnToRam/test/tdd/iwToJavaInstantiator/TestHelper.kmt"

using kermeta::standard
using kermeta::kunit
using intermediateWorkflow
using aoUrnToRam::util 

class IwToJavaInstantiator_IwWorkflowTestCase inherits TestCase,IwToJavaInstantiator_TestHelper
{
	reference sut:IwWorkflow
	reference textView:TextView
	
	method setUp() is do
		sut:=withContainers_Workflow(createIwWorkflow)
	end

	operation testToWorkflowInstantiator_ShouldInitWorkspacePath() is do
		textView:=sut.jiToWorkflowInstantiator
		
		assertEquals("Instantiators/theConcern/theWorkflowWorkflowInstantiator",textView.workspacePath)
	end

	operation testToWorkflowInstantiator_ShouldAppendPackage() is do
		textView:=sut.jiToWorkflowInstantiator
		
		assertStringStartsWith("package theModel.Instantiators.theConcern;\n\n",textView.content)
	end

	operation testToWorkflowInstantiator_ShouldAppendImports() is do
		textView:=sut.jiToWorkflowInstantiator
		
		assertStringContains( "import ram.reactiveworkflow.*;\n",textView.content)
		assertStringContains( "import ram.workflow.*;\n",textView.content)
	end

	operation testToWorkflowInstantiator_ShouldAppendClassPre() is do
		textView:=sut.jiToWorkflowInstantiator
		
		assertStringContains("\n\npublic class theWorkflowWorkflowInstantiator extends WorkflowInstantiator{",textView.content)
	end

	operation testToWorkflowInstantiator_ShouldAppendClassPost() is do
		textView:=sut.jiToWorkflowInstantiator
		
		assertStringEndsWith("}\n",textView.content)
	end


	operation testToWorkflowInstantiator_ShouldInvokeAppendBuildStatementOnNodes() is do
		createIwInput_Workflow(sut)
		createIwInput_Workflow(sut)
		
		textView:=sut.jiToWorkflowInstantiator
		
		assertStringContainsExpectedNTime("new",2,textView.content)
	end

	
}
