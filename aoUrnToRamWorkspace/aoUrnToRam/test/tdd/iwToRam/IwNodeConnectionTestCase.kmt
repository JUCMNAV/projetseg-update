package aoUrnToRam::Test;

require kermeta
require "platform:/resource/aoUrnToRam/test/tdd/iwToRam/TestHelper.kmt"

using kermeta::standard
using kermeta::kunit
using intermediateWorkflow
using ramstructural

class IwToRam_IwNodeConnectionTestCase inherits TestCase,IwToRam_TestHelper
{
	reference sut:IwNodeConnection
	
	method setUp() is do
		sut:=createIwConditionalNodeConnection_Source(createIwOrFork)
	end
	
	@feature "FeaTransformOrFork"
	operation testBuild_ShouldBuildConditionClass() is do
		sut.build
		
		assertRamClassNameEquals(sut.source.name+"_"+sut.conditionName,sut.ramCondition)
	end

	@feature "FeaTransformOrFork"
	operation testLink_ShouldAddConditionClassToClassDiagram() is do
		var step:IwStep init setupAndExeLink
		
		assertCollectionHasSingleElement(sut.ramCondition,step.ramStructuralView.classes)
	end

	@feature "FeaTransformOrFork"
	operation testLink_ShouldMapConditionClass() is do
		var step:IwStep init setupAndExeLink
		
		assertRamMappingHasSingleElement(sut.ramCondition,step.REACTIVE_WORKFLOW_CONDITION,step)
	end
	
	
	operation setupAndExeLink():IwStep is do
		result:=createIwStep
		sut.source.step:=result
		result.build
		
		sut.link
	end
}